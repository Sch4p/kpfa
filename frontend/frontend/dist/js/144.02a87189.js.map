{"version":3,"file":"js/144.02a87189.js","mappings":"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","sources":["webpack://frontend/./src/views/CheckOut_Candidate.vue","webpack://frontend/./src/views/CheckOut_Candidate.vue?816c"],"sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <!-- Loader -->\r\n    <div v-if=\"loading\" class=\"text-center my-5\">\r\n      <div class=\"spinner-border text-primary\" role=\"status\">\r\n        <span class=\"visually-hidden\">Loading candidate details...</span>\r\n      </div>\r\n      <p class=\"mt-3\">Loading candidate details...</p>\r\n    </div>\r\n\r\n    <!-- Candidate Details -->\r\n    <div v-else-if=\"candidate\" class=\"card shadow p-4 mx-auto\" style=\"max-width: 600px;\">\r\n      <h4 class=\"mb-3 text-center\">Candidate Application Checkout</h4>\r\n\r\n      <div class=\"mb-3\">\r\n        <p><strong>Full Name:</strong> {{ candidate.first_name }} {{ candidate.surname }}</p>\r\n        <p><strong>Email:</strong> {{ candidate.email || \"N/A\" }}</p>\r\n        <p><strong>Phone:</strong> {{ candidate.phone_country_code }} {{ candidate.phone_number }}</p>\r\n        <p><strong>Country:</strong> {{ candidate.country?.name || \"N/A\" }}</p>\r\n        <p><strong>State:</strong> {{ candidate.state_of_origin?.name || \"N/A\" }}</p>\r\n        <p><strong>Team:</strong> {{ candidate.team_name || \"N/A\" }}</p>\r\n      </div>\r\n\r\n      <hr />\r\n\r\n      <h5 class=\"mb-3 text-center text-success\">Application Fee: ‚Ç¶10,000</h5>\r\n\r\n      <!-- Payment Method -->\r\n      <div class=\"mb-3 mx-auto\" style=\"max-width: 300px;\">\r\n        <label for=\"paymentMethod\" class=\"form-label fw-bold\">Payment Method</label>\r\n        <select\r\n          id=\"paymentMethod\"\r\n          v-model=\"selectedPayment\"\r\n          class=\"form-select\"\r\n        >\r\n          <option disabled value=\"\">Select Payment Option</option>\r\n          <option value=\"OPAY\">Opay</option>\r\n          <option value=\"BANK\">Bank Transfer</option>\r\n        </select>\r\n      </div>\r\n\r\n      <!-- Proceed Button -->\r\n      <button\r\n        class=\"btn btn-primary w-100 mt-2\"\r\n        :disabled=\"!selectedPayment || submitting\"\r\n        @click=\"proceedToPayment\"\r\n      >\r\n        <span v-if=\"submitting\" class=\"spinner-border spinner-border-sm me-2\"></span>\r\n        Proceed to Payment\r\n      </button>\r\n\r\n      <!-- Feedback -->\r\n      <div v-if=\"feedback.message\" class=\"alert mt-3\" :class=\"feedback.type\" role=\"alert\">\r\n        {{ feedback.message }}\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Error Loading Candidate -->\r\n    <div v-else class=\"text-center text-danger my-5\">\r\n      <p> Candidate details could not be loaded.</p>\r\n    </div>\r\n    <div v-if=\"paymentError\" class=\"alert alert-warning mt-3\">\r\n      {{ paymentError }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"CheckOut_Candidate\",\r\n  props: {\r\n    candidateId: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      candidate: null,\r\n      loading: true,\r\n      submitting: false,\r\n      selectedPayment: \"\",\r\n      feedback: {\r\n        message: \"\",\r\n        type: \"\",\r\n      },\r\n      paymentError: null,\r\n    };\r\n  },\r\n  methods: {\r\n    // ‚úÖ Load candidate details on mount\r\n    async fetchCandidate() {\r\n      this.loading = true;\r\n      try {\r\n        const res = await axios.get(\r\n          `http://127.0.0.1:8000/api/candidates/${encodeURIComponent(this.candidateId)}/`\r\n        );\r\n        this.candidate = res.data;\r\n        console.log(\"‚úÖ Candidate loaded:\", this.candidate);\r\n      } catch (error) {\r\n        console.error(\"‚ùå Error loading candidate:\", error);\r\n        this.feedback = {\r\n          message: \"Failed to load candidate details.\",\r\n          type: \"alert-danger\",\r\n        };\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    // ‚úÖ Proceed to payment\r\n    async proceedToPayment() {\r\n      this.paymentError = null;\r\n      this.feedback = { message: \"\", type: \"\" };\r\n\r\n    if (this.submitting) return;\r\n\r\n    if (!this.selectedPayment) {\r\n    this.feedback = {\r\n      message: \"Please select a payment method.\",\r\n      type: \"alert-warning\",\r\n    };\r\n      return;\r\n  }\r\n\r\n  this.submitting = true;\r\n  this.feedback = { message: \"\", type: \"\" };\r\n  this.paymentError = null;\r\n\r\n  try {\r\n    this.loading = true;\r\n\r\n    // Step 1Ô∏è‚É£: Ensure candidate is loaded\r\n    if (!this.candidate) {\r\n      await this.fetchCandidate();\r\n    }\r\n\r\n    // Step 2Ô∏è‚É£: Check for existing payment\r\n    const checkRes = await axios.get(\r\n      `http://127.0.0.1:8000/api/payments/candidate/check/${this.candidate.id}/`\r\n    );\r\n\r\n    if (checkRes.data.exists) {\r\n      this.paymentError =\r\n        \"This candidate already has a payment record. You cannot pay twice.\";\r\n      this.loading = false;\r\n      this.submitting = false;\r\n      return;\r\n    }\r\n\r\n    console.log(\"üì¶ Sending payload:\", {\r\n    candidate: this.candidate.id,\r\n    amount: 10000,\r\n    method: this.selectedPayment,\r\n  });\r\n    // Step 3Ô∏è‚É£: Initiate payment\r\n    const paymentRes = await axios.post(\r\n      \"http://127.0.0.1:8000/api/payments/candidate/mock-initiate/\",\r\n      {\r\n        candidate: this.candidate.id,\r\n        amount: 10000,\r\n        method: this.selectedPayment,\r\n      }\r\n    );\r\n\r\n    this.paymentResponse = paymentRes.data;\r\n    console.log(\"‚úÖ Payment initiated:\", this.paymentResponse);\r\n\r\n    // ‚úÖ FIX: Extract reference correctly from nested response structure\r\n    const reference = this.paymentResponse?.data?.reference;\r\n    if (!reference) {\r\n      console.error(\"‚ùå Missing reference in response:\", this.paymentResponse);\r\n      this.paymentError = \"Could not generate payment reference. Please retry.\";\r\n      this.loading = false;\r\n      this.submitting = false;\r\n      return;\r\n    }\r\n\r\n    console.log(\"Redirecting with reference:\", reference);\r\n\r\n    // Step 4Ô∏è‚É£: Redirect to Mock Payment Page\r\n    alert(\"‚úÖ Proceeding to payment gateway...\");\r\n    window.location.href = this.paymentResponse.data.opay_mock_url;\r\n  } catch (error) {\r\n    console.error(\"üî• Payment error:\", error.response?.data || error);\r\n\r\n    // Handle network or timeout errors gracefully\r\n    if (error.message.includes(\"Network Error\")) {\r\n      const retry = confirm(\r\n        \"‚ö†Ô∏è Network error detected.\\nWould you like to retry payment?\"\r\n      );\r\n      if (retry) {\r\n        this.submitting = false;\r\n        this.proceedToPayment();\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.paymentError =\r\n      error.response?.data?.message ||\r\n      \"Payment failed. Please check your internet and try again.\";\r\n  } finally {\r\n    this.loading = false;\r\n    this.submitting = false;\r\n  }\r\n}\r\n\r\n  },\r\n\r\n  // ‚úÖ Load candidate immediately\r\n  mounted() {\r\n    console.log(\"Candidate ID from route:\", this.candidateId);\r\n    this.fetchCandidate();\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style scoped>\r\n.card {\r\n  border-radius: 15px;\r\n}\r\n\r\n.form-select {\r\n  border-radius: 10px;\r\n  max-width: 100%;\r\n}\r\n\r\n.alert {\r\n  border-radius: 10px;\r\n}\r\n/**Switching to Payment Gateway Provider.s Network */\r\n</style>\r\n","import { render } from \"./CheckOut_Candidate.vue?vue&type=template&id=85ed2c0c&scoped=true\"\nimport script from \"./CheckOut_Candidate.vue?vue&type=script&lang=js\"\nexport * from \"./CheckOut_Candidate.vue?vue&type=script&lang=js\"\n\nimport \"./CheckOut_Candidate.vue?vue&type=style&index=0&id=85ed2c0c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-85ed2c0c\"]])\n\nexport default __exports__"],"names":["class","style","_createElementBlock","_hoisted_1","$data","loading","_hoisted_2","_cache","_createElementVNode","role","candidate","_hoisted_3","_hoisted_4","_toDisplayString","first_name","surname","email","phone_country_code","phone_number","country","name","state_of_origin","team_name","_hoisted_5","for","id","selectedPayment","$event","disabled","value","submitting","onClick","args","$options","proceedToPayment","_hoisted_7","feedback","message","_normalizeClass","type","_hoisted_8","paymentError","_hoisted_9","props","candidateId","String","required","data","methods","fetchCandidate","this","res","axios","get","encodeURIComponent","console","log","error","checkRes","exists","amount","method","paymentRes","post","paymentResponse","reference","alert","window","location","href","opay_mock_url","response","includes","retry","confirm","mounted","__exports__","render"],"sourceRoot":""}